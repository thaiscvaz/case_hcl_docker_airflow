[2024-03-30T00:40:05.128+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: migrate_student_data_to_snowflake.load_data_to_snowflake scheduled__2024-03-29T00:00:00+00:00 [queued]>
[2024-03-30T00:40:05.137+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: migrate_student_data_to_snowflake.load_data_to_snowflake scheduled__2024-03-29T00:00:00+00:00 [queued]>
[2024-03-30T00:40:05.139+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 2
[2024-03-30T00:40:05.153+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): load_data_to_snowflake> on 2024-03-29 00:00:00+00:00
[2024-03-30T00:40:05.159+0000] {standard_task_runner.py:60} INFO - Started process 98 to run task
[2024-03-30T00:40:05.162+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'migrate_student_data_to_snowflake', 'load_data_to_snowflake', 'scheduled__2024-03-29T00:00:00+00:00', '--job-id', '101', '--raw', '--subdir', 'DAGS_FOLDER/student_data_migration.py', '--cfg-path', '/tmp/tmp0e5d007r']
[2024-03-30T00:40:05.165+0000] {standard_task_runner.py:88} INFO - Job 101: Subtask load_data_to_snowflake
[2024-03-30T00:40:05.219+0000] {task_command.py:423} INFO - Running <TaskInstance: migrate_student_data_to_snowflake.load_data_to_snowflake scheduled__2024-03-29T00:00:00+00:00 [running]> on host 2417d3f97037
[2024-03-30T00:40:05.372+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='migrate_student_data_to_snowflake' AIRFLOW_CTX_TASK_ID='load_data_to_snowflake' AIRFLOW_CTX_EXECUTION_DATE='2024-03-29T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-03-29T00:00:00+00:00'
[2024-03-30T00:40:05.374+0000] {connection.py:386} INFO - Snowflake Connector for Python Version: 3.7.1, Python Version: 3.8.19, Platform: Linux-5.15.146.1-microsoft-standard-WSL2-x86_64-with-glibc2.34
[2024-03-30T00:40:05.375+0000] {connection.py:1211} INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
[2024-03-30T00:40:06.589+0000] {connection.py:547} WARNING - Certificate did not match expected hostname: xzazqxs.os03767.snowflakecomputing.com. Certificate: {'subject': ((('commonName', '*.prod3.us-west-2.snowflakecomputing.com'),),), 'subjectAltName': [('DNS', '*.prod3.us-west-2.snowflakecomputing.com'), ('DNS', '*.us-west-2.snowflakecomputing.com'), ('DNS', '*.global.snowflakecomputing.com'), ('DNS', '*.snowflakecomputing.com'), ('DNS', '*.prod3.us-west-2.aws.snowflakecomputing.com')]}
[2024-03-30T00:40:06.591+0000] {connectionpool.py:824} WARNING - Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'SSLError(CertificateError("hostname 'xzazqxs.os03767.snowflakecomputing.com' doesn't match either of '*.prod3.us-west-2.snowflakecomputing.com', '*.us-west-2.snowflakecomputing.com', '*.global.snowflakecomputing.com', '*.snowflakecomputing.com', '*.prod3.us-west-2.aws.snowflakecomputing.com'"))': /session/v1/login-request?request_id=06a9f14c-c3b0-4292-ae1e-989d185d26ed&request_guid=2248484b-eece-4d34-a05f-efcffb44f23a
[2024-03-30T00:40:07.256+0000] {connection.py:547} WARNING - Certificate did not match expected hostname: xzazqxs.os03767.snowflakecomputing.com. Certificate: {'subject': ((('commonName', '*.prod3.us-west-2.snowflakecomputing.com'),),), 'subjectAltName': [('DNS', '*.prod3.us-west-2.snowflakecomputing.com'), ('DNS', '*.us-west-2.snowflakecomputing.com'), ('DNS', '*.global.snowflakecomputing.com'), ('DNS', '*.snowflakecomputing.com'), ('DNS', '*.prod3.us-west-2.aws.snowflakecomputing.com')]}
[2024-03-30T00:40:07.261+0000] {network.py:1029} ERROR - Failed to get the response. Hanging? method: post, url: https://XZAZQXS.OS03767.snowflakecomputing.com:443/session/v1/login-request?request_id=06a9f14c-c3b0-4292-ae1e-989d185d26ed&request_guid=2248484b-eece-4d34-a05f-efcffb44f23a, headers:{'Content-Type': 'application/json', 'accept': 'application/snowflake', 'User-Agent': 'PythonConnector/3.7.1 (Linux-5.15.146.1-microsoft-standard-WSL2-x86_64-with-glibc2.34) CPython/3.8.19', 'Content-Encoding': 'gzip'}, data: {"data": {"CLIENT_APP_ID": "PythonConnector", "CLIENT_APP_VERSION": "3.7.1", "SVN_REVISION": null, "ACCOUNT_NAME": "XZAZQXS", "LOGIN_NAME": "THAISCVAZ", "CLIENT_ENVIRONMENT": {"APPLICATION": "PythonConnector", "OS": "Linux", "OS_VERSION": "Linux-5.15.146.1-microsoft-standard-WSL2-x86_64-with-glibc2.34", "PYTHON_VERSION": "3.8.19", "PYTHON_RUNTIME": "CPython", "PYTHON_COMPILER": "GCC 12.2.0", "OCSP_MODE": "FAIL_OPEN", "TRACING": 20, "LOGIN_TIMEOUT": null, "NETWORK_TIMEOUT": null, "SOCKET_TIMEOUT": null}, "PASSWORD": "**** "SESSION_PARAMETERS": {"CLIENT_PREFETCH_THREADS": 4}}}
[2024-03-30T00:40:08.932+0000] {connection.py:547} WARNING - Certificate did not match expected hostname: xzazqxs.os03767.snowflakecomputing.com. Certificate: {'subject': ((('commonName', '*.prod3.us-west-2.snowflakecomputing.com'),),), 'subjectAltName': [('DNS', '*.prod3.us-west-2.snowflakecomputing.com'), ('DNS', '*.us-west-2.snowflakecomputing.com'), ('DNS', '*.global.snowflakecomputing.com'), ('DNS', '*.snowflakecomputing.com'), ('DNS', '*.prod3.us-west-2.aws.snowflakecomputing.com')]}
[2024-03-30T00:40:08.934+0000] {connectionpool.py:824} WARNING - Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'SSLError(CertificateError("hostname 'xzazqxs.os03767.snowflakecomputing.com' doesn't match either of '*.prod3.us-west-2.snowflakecomputing.com', '*.us-west-2.snowflakecomputing.com', '*.global.snowflakecomputing.com', '*.snowflakecomputing.com', '*.prod3.us-west-2.aws.snowflakecomputing.com'"))': /session/v1/login-request?request_id=d6ac8780-2748-46a2-b91c-474c9d5e98b7&request_guid=5d26b953-2181-42eb-b602-e49c0a0ef6db
[2024-03-30T00:40:09.590+0000] {connection.py:547} WARNING - Certificate did not match expected hostname: xzazqxs.os03767.snowflakecomputing.com. Certificate: {'subject': ((('commonName', '*.prod3.us-west-2.snowflakecomputing.com'),),), 'subjectAltName': [('DNS', '*.prod3.us-west-2.snowflakecomputing.com'), ('DNS', '*.us-west-2.snowflakecomputing.com'), ('DNS', '*.global.snowflakecomputing.com'), ('DNS', '*.snowflakecomputing.com'), ('DNS', '*.prod3.us-west-2.aws.snowflakecomputing.com')]}
[2024-03-30T00:40:09.595+0000] {network.py:1029} ERROR - Failed to get the response. Hanging? method: post, url: https://XZAZQXS.OS03767.snowflakecomputing.com:443/session/v1/login-request?request_id=d6ac8780-2748-46a2-b91c-474c9d5e98b7&request_guid=5d26b953-2181-42eb-b602-e49c0a0ef6db, headers:{'Content-Type': 'application/json', 'accept': 'application/snowflake', 'User-Agent': 'PythonConnector/3.7.1 (Linux-5.15.146.1-microsoft-standard-WSL2-x86_64-with-glibc2.34) CPython/3.8.19', 'Content-Encoding': 'gzip'}, data: {"data": {"CLIENT_APP_ID": "PythonConnector", "CLIENT_APP_VERSION": "3.7.1", "SVN_REVISION": null, "ACCOUNT_NAME": "XZAZQXS", "LOGIN_NAME": "THAISCVAZ", "CLIENT_ENVIRONMENT": {"APPLICATION": "PythonConnector", "OS": "Linux", "OS_VERSION": "Linux-5.15.146.1-microsoft-standard-WSL2-x86_64-with-glibc2.34", "PYTHON_VERSION": "3.8.19", "PYTHON_RUNTIME": "CPython", "PYTHON_COMPILER": "GCC 12.2.0", "OCSP_MODE": "FAIL_OPEN", "TRACING": 20, "LOGIN_TIMEOUT": null, "NETWORK_TIMEOUT": null, "SOCKET_TIMEOUT": null}, "PASSWORD": "**** "SESSION_PARAMETERS": {"CLIENT_PREFETCH_THREADS": 4}}}
[2024-03-30T00:40:09.600+0000] {student_data_migration.py:144} ERROR - Error loading data into Snowflake: 250001: 250001: Could not connect to Snowflake backend after 2 attempt(s).Aborting
[2024-03-30T00:40:09.601+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 1345, in _authenticate
    auth.authenticate(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/auth/_auth.py", line 250, in authenticate
    ret = self._rest._post_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/network.py", line 734, in _post_request
    ret = self.fetch(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/network.py", line 843, in fetch
    ret = self._request_exec_wrapper(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/network.py", line 979, in _request_exec_wrapper
    raise e
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/network.py", line 895, in _request_exec_wrapper
    self._handle_unknown_error(method, full_url, headers, data, conn)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/network.py", line 1034, in _handle_unknown_error
    Error.errorhandler_wrapper(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/errors.py", line 290, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/errors.py", line 348, in hand_to_other_handler
    connection.errorhandler(connection, cursor, error_class, error_value)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/errors.py", line 221, in default_errorhandler
    raise error_class(
snowflake.connector.errors.OperationalError: 250003: 250003: Failed to get the response. Hanging? method: post, url: https://XZAZQXS.OS03767.snowflakecomputing.com:443/session/v1/login-request?request_id=06a9f14c-c3b0-4292-ae1e-989d185d26ed&request_guid=2248484b-eece-4d34-a05f-efcffb44f23a

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/airflow/dags/student_data_migration.py", line 115, in load_data_to_snowflake
    conn = snowflake.connector.connect(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/__init__.py", line 54, in Connect
    return SnowflakeConnection(**kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 429, in __init__
    self.connect(**kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 719, in connect
    self.__open_connection()
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 1045, in __open_connection
    self.authenticate_with_retry(self.auth_class)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 1317, in authenticate_with_retry
    self._authenticate(auth_instance)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 1389, in _authenticate
    raise auth_op from e
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 1366, in _authenticate
    auth_instance.handle_timeout(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/auth/by_plugin.py", line 212, in handle_timeout
    raise error
snowflake.connector.errors.OperationalError: 250001: 250001: Could not connect to Snowflake backend after 2 attempt(s).Aborting

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 200, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 217, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/student_data_migration.py", line 147, in load_data_to_snowflake
    cursor.close()
UnboundLocalError: local variable 'cursor' referenced before assignment
[2024-03-30T00:40:09.611+0000] {taskinstance.py:1149} INFO - Marking task as UP_FOR_RETRY. dag_id=migrate_student_data_to_snowflake, task_id=load_data_to_snowflake, execution_date=20240329T000000, start_date=20240330T004005, end_date=20240330T004009
[2024-03-30T00:40:09.633+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 101 for task load_data_to_snowflake (local variable 'cursor' referenced before assignment; 98)
[2024-03-30T00:40:09.680+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-03-30T00:40:09.701+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-03-30T01:51:12.240+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: migrate_student_data_to_snowflake.load_data_to_snowflake scheduled__2024-03-29T00:00:00+00:00 [queued]>
[2024-03-30T01:51:12.248+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: migrate_student_data_to_snowflake.load_data_to_snowflake scheduled__2024-03-29T00:00:00+00:00 [queued]>
[2024-03-30T01:51:12.248+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 2
[2024-03-30T01:51:12.259+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): load_data_to_snowflake> on 2024-03-29 00:00:00+00:00
[2024-03-30T01:51:12.264+0000] {standard_task_runner.py:60} INFO - Started process 106 to run task
[2024-03-30T01:51:12.267+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'migrate_student_data_to_snowflake', 'load_data_to_snowflake', 'scheduled__2024-03-29T00:00:00+00:00', '--job-id', '142', '--raw', '--subdir', 'DAGS_FOLDER/student_data_migration.py', '--cfg-path', '/tmp/tmp84j03lyj']
[2024-03-30T01:51:12.270+0000] {standard_task_runner.py:88} INFO - Job 142: Subtask load_data_to_snowflake
[2024-03-30T01:51:12.310+0000] {task_command.py:423} INFO - Running <TaskInstance: migrate_student_data_to_snowflake.load_data_to_snowflake scheduled__2024-03-29T00:00:00+00:00 [running]> on host 4eb3fd2c57a4
[2024-03-30T01:51:12.421+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='migrate_student_data_to_snowflake' AIRFLOW_CTX_TASK_ID='load_data_to_snowflake' AIRFLOW_CTX_EXECUTION_DATE='2024-03-29T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-03-29T00:00:00+00:00'
[2024-03-30T01:51:12.423+0000] {connection.py:386} INFO - Snowflake Connector for Python Version: 3.7.1, Python Version: 3.8.19, Platform: Linux-5.15.146.1-microsoft-standard-WSL2-x86_64-with-glibc2.34
[2024-03-30T01:51:12.423+0000] {connection.py:1211} INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
[2024-03-30T01:51:13.398+0000] {cursor.py:1032} INFO - query: [CREATE OR REPLACE TABLE FINAL_MERGED ( student_id VARCHAR, name VARCHAR, grades ...]
[2024-03-30T01:51:13.504+0000] {cursor.py:1045} INFO - query execution done
[2024-03-30T01:51:13.518+0000] {student_data_migration.py:139} ERROR - Error loading data into Snowflake: 090105 (22000): 01b352ea-0000-3e11-0000-000049912639: Cannot perform CREATE TABLE. This session does not have a current database. Call 'USE DATABASE', or use a qualified name.
[2024-03-30T01:51:13.519+0000] {connection.py:734} INFO - closed
[2024-03-30T01:51:13.573+0000] {connection.py:740} INFO - No async queries seem to be running, deleting session
[2024-03-30T01:51:13.622+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 200, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 217, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/student_data_migration.py", line 122, in load_data_to_snowflake
    cursor.execute("""
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 1136, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/errors.py", line 290, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/errors.py", line 345, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/errors.py", line 221, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 090105 (22000): 01b352ea-0000-3e11-0000-000049912639: Cannot perform CREATE TABLE. This session does not have a current database. Call 'USE DATABASE', or use a qualified name.
[2024-03-30T01:51:13.630+0000] {taskinstance.py:1149} INFO - Marking task as UP_FOR_RETRY. dag_id=migrate_student_data_to_snowflake, task_id=load_data_to_snowflake, execution_date=20240329T000000, start_date=20240330T015112, end_date=20240330T015113
[2024-03-30T01:51:13.641+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 142 for task load_data_to_snowflake (090105 (22000): 01b352ea-0000-3e11-0000-000049912639: Cannot perform CREATE TABLE. This session does not have a current database. Call 'USE DATABASE', or use a qualified name.; 106)
[2024-03-30T01:51:13.685+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-03-30T01:51:13.701+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-03-30T02:25:28.571+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: migrate_student_data_to_snowflake.load_data_to_snowflake scheduled__2024-03-29T00:00:00+00:00 [queued]>
[2024-03-30T02:25:28.581+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: migrate_student_data_to_snowflake.load_data_to_snowflake scheduled__2024-03-29T00:00:00+00:00 [queued]>
[2024-03-30T02:25:28.581+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 2
[2024-03-30T02:25:28.601+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): load_data_to_snowflake> on 2024-03-29 00:00:00+00:00
[2024-03-30T02:25:28.612+0000] {standard_task_runner.py:60} INFO - Started process 91 to run task
[2024-03-30T02:25:28.616+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'migrate_student_data_to_snowflake', 'load_data_to_snowflake', 'scheduled__2024-03-29T00:00:00+00:00', '--job-id', '181', '--raw', '--subdir', 'DAGS_FOLDER/student_data_migration.py', '--cfg-path', '/tmp/tmptmresxnu']
[2024-03-30T02:25:28.619+0000] {standard_task_runner.py:88} INFO - Job 181: Subtask load_data_to_snowflake
[2024-03-30T02:25:28.668+0000] {task_command.py:423} INFO - Running <TaskInstance: migrate_student_data_to_snowflake.load_data_to_snowflake scheduled__2024-03-29T00:00:00+00:00 [running]> on host ad4496215849
[2024-03-30T02:25:28.797+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='migrate_student_data_to_snowflake' AIRFLOW_CTX_TASK_ID='load_data_to_snowflake' AIRFLOW_CTX_EXECUTION_DATE='2024-03-29T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-03-29T00:00:00+00:00'
[2024-03-30T02:25:28.799+0000] {connection.py:386} INFO - Snowflake Connector for Python Version: 3.7.1, Python Version: 3.8.19, Platform: Linux-5.15.146.1-microsoft-standard-WSL2-x86_64-with-glibc2.34
[2024-03-30T02:25:28.800+0000] {connection.py:1211} INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
[2024-03-30T02:25:29.574+0000] {cursor.py:1032} INFO - query: [CREATE DATABASE IF NOT EXISTS VIEWS_STUDENTS]
[2024-03-30T02:25:29.686+0000] {cursor.py:1045} INFO - query execution done
[2024-03-30T02:25:29.687+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-03-30T02:25:29.688+0000] {cursor.py:1032} INFO - query: [USE DATABASE VIEWS_STUDENTS]
[2024-03-30T02:25:29.813+0000] {cursor.py:1045} INFO - query execution done
[2024-03-30T02:25:29.814+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-03-30T02:25:29.814+0000] {cursor.py:1032} INFO - query: [CREATE SCHEMA IF NOT EXISTS STUDENTS_SEMANTIC]
[2024-03-30T02:25:29.891+0000] {cursor.py:1045} INFO - query execution done
[2024-03-30T02:25:29.892+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-03-30T02:25:29.893+0000] {cursor.py:1032} INFO - query: [USE SCHEMA STUDENTS_SEMANTIC]
[2024-03-30T02:25:29.981+0000] {cursor.py:1045} INFO - query execution done
[2024-03-30T02:25:29.981+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-03-30T02:25:29.982+0000] {cursor.py:1032} INFO - query: [CREATE OR REPLACE TABLE FINAL_MERGED ( student_id VARCHAR, name VARCHAR, grades ...]
[2024-03-30T02:25:30.301+0000] {cursor.py:1045} INFO - query execution done
[2024-03-30T02:25:30.302+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-03-30T02:25:30.311+0000] {student_data_migration.py:142} ERROR - Error loading data into Snowflake: 252004: 252004: Failed processing pyformat-parameters; 255001: 255001: Binding data in type (dict) is not supported.
[2024-03-30T02:25:30.311+0000] {connection.py:734} INFO - closed
[2024-03-30T02:25:30.370+0000] {connection.py:740} INFO - No async queries seem to be running, deleting session
[2024-03-30T02:25:30.430+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 1517, in _process_params_pyformat
    ret = tuple(res)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 1563, in _process_single_param
    return _quote(escape(to_snowflake(param)))
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/converter.py", line 481, in to_snowflake
    return getattr(self, f"_{type_name}_to_snowflake")(value)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/converter.py", line 653, in __getattr__
    raise ProgrammingError(
snowflake.connector.errors.ProgrammingError: 255001: 255001: Binding data in type (dict) is not supported.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 200, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 217, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/student_data_migration.py", line 137, in load_data_to_snowflake
    cursor.executemany(query, data)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 1430, in executemany
    fmt % self._connection._process_params_pyformat(param, self)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 1521, in _process_params_pyformat
    Error.errorhandler_wrapper(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/errors.py", line 290, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/errors.py", line 345, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/errors.py", line 221, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 252004: 252004: Failed processing pyformat-parameters; 255001: 255001: Binding data in type (dict) is not supported.
[2024-03-30T02:25:30.437+0000] {taskinstance.py:1149} INFO - Marking task as UP_FOR_RETRY. dag_id=migrate_student_data_to_snowflake, task_id=load_data_to_snowflake, execution_date=20240329T000000, start_date=20240330T022528, end_date=20240330T022530
[2024-03-30T02:25:30.448+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 181 for task load_data_to_snowflake (252004: 252004: Failed processing pyformat-parameters; 255001: 255001: Binding data in type (dict) is not supported.; 91)
[2024-03-30T02:25:30.477+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-03-30T02:25:30.491+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-03-30T02:30:27.407+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: migrate_student_data_to_snowflake.load_data_to_snowflake scheduled__2024-03-29T00:00:00+00:00 [queued]>
[2024-03-30T02:30:27.413+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: migrate_student_data_to_snowflake.load_data_to_snowflake scheduled__2024-03-29T00:00:00+00:00 [queued]>
[2024-03-30T02:30:27.414+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 2
[2024-03-30T02:30:27.424+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): load_data_to_snowflake> on 2024-03-29 00:00:00+00:00
[2024-03-30T02:30:27.429+0000] {standard_task_runner.py:60} INFO - Started process 90 to run task
[2024-03-30T02:30:27.432+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'migrate_student_data_to_snowflake', 'load_data_to_snowflake', 'scheduled__2024-03-29T00:00:00+00:00', '--job-id', '192', '--raw', '--subdir', 'DAGS_FOLDER/student_data_migration.py', '--cfg-path', '/tmp/tmpdm2f4m1_']
[2024-03-30T02:30:27.435+0000] {standard_task_runner.py:88} INFO - Job 192: Subtask load_data_to_snowflake
[2024-03-30T02:30:27.472+0000] {task_command.py:423} INFO - Running <TaskInstance: migrate_student_data_to_snowflake.load_data_to_snowflake scheduled__2024-03-29T00:00:00+00:00 [running]> on host c5cf3f729977
[2024-03-30T02:30:27.615+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='migrate_student_data_to_snowflake' AIRFLOW_CTX_TASK_ID='load_data_to_snowflake' AIRFLOW_CTX_EXECUTION_DATE='2024-03-29T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-03-29T00:00:00+00:00'
[2024-03-30T02:30:27.616+0000] {connection.py:386} INFO - Snowflake Connector for Python Version: 3.7.1, Python Version: 3.8.19, Platform: Linux-5.15.146.1-microsoft-standard-WSL2-x86_64-with-glibc2.34
[2024-03-30T02:30:27.617+0000] {connection.py:1211} INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
[2024-03-30T02:30:28.355+0000] {cursor.py:1032} INFO - query: [CREATE DATABASE IF NOT EXISTS VIEWS_STUDENTS]
[2024-03-30T02:30:28.468+0000] {cursor.py:1045} INFO - query execution done
[2024-03-30T02:30:28.469+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-03-30T02:30:28.469+0000] {cursor.py:1032} INFO - query: [USE DATABASE VIEWS_STUDENTS]
[2024-03-30T02:30:28.587+0000] {cursor.py:1045} INFO - query execution done
[2024-03-30T02:30:28.587+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-03-30T02:30:28.588+0000] {cursor.py:1032} INFO - query: [CREATE SCHEMA IF NOT EXISTS STUDENTS_SEMANTIC]
[2024-03-30T02:30:28.664+0000] {cursor.py:1045} INFO - query execution done
[2024-03-30T02:30:28.665+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-03-30T02:30:28.666+0000] {cursor.py:1032} INFO - query: [USE SCHEMA STUDENTS_SEMANTIC]
[2024-03-30T02:30:28.771+0000] {cursor.py:1045} INFO - query execution done
[2024-03-30T02:30:28.771+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-03-30T02:30:28.772+0000] {cursor.py:1032} INFO - query: [CREATE OR REPLACE TABLE FINAL_MERGED ( student_id VARCHAR, name VARCHAR, grades ...]
[2024-03-30T02:30:29.096+0000] {cursor.py:1045} INFO - query execution done
[2024-03-30T02:30:29.098+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-03-30T02:30:29.106+0000] {student_data_migration.py:144} ERROR - Error loading data into Snowflake: 252004: 252004: Failed processing pyformat-parameters; 255001: 255001: Binding data in type (dict) is not supported.
[2024-03-30T02:30:29.106+0000] {connection.py:734} INFO - closed
[2024-03-30T02:30:29.148+0000] {connection.py:740} INFO - No async queries seem to be running, deleting session
[2024-03-30T02:30:29.209+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 1517, in _process_params_pyformat
    ret = tuple(res)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 1563, in _process_single_param
    return _quote(escape(to_snowflake(param)))
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/converter.py", line 481, in to_snowflake
    return getattr(self, f"_{type_name}_to_snowflake")(value)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/converter.py", line 653, in __getattr__
    raise ProgrammingError(
snowflake.connector.errors.ProgrammingError: 255001: 255001: Binding data in type (dict) is not supported.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 200, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 217, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/student_data_migration.py", line 139, in load_data_to_snowflake
    cursor.executemany(query, data)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 1430, in executemany
    fmt % self._connection._process_params_pyformat(param, self)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 1521, in _process_params_pyformat
    Error.errorhandler_wrapper(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/errors.py", line 290, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/errors.py", line 345, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/errors.py", line 221, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 252004: 252004: Failed processing pyformat-parameters; 255001: 255001: Binding data in type (dict) is not supported.
[2024-03-30T02:30:29.217+0000] {taskinstance.py:1149} INFO - Marking task as UP_FOR_RETRY. dag_id=migrate_student_data_to_snowflake, task_id=load_data_to_snowflake, execution_date=20240329T000000, start_date=20240330T023027, end_date=20240330T023029
[2024-03-30T02:30:29.234+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 192 for task load_data_to_snowflake (252004: 252004: Failed processing pyformat-parameters; 255001: 255001: Binding data in type (dict) is not supported.; 90)
[2024-03-30T02:30:29.253+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-03-30T02:30:29.267+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-03-30T02:40:32.764+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: migrate_student_data_to_snowflake.load_data_to_snowflake scheduled__2024-03-29T00:00:00+00:00 [queued]>
[2024-03-30T02:40:32.772+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: migrate_student_data_to_snowflake.load_data_to_snowflake scheduled__2024-03-29T00:00:00+00:00 [queued]>
[2024-03-30T02:40:32.772+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 2
[2024-03-30T02:40:32.782+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): load_data_to_snowflake> on 2024-03-29 00:00:00+00:00
[2024-03-30T02:40:32.788+0000] {standard_task_runner.py:60} INFO - Started process 90 to run task
[2024-03-30T02:40:32.790+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'migrate_student_data_to_snowflake', 'load_data_to_snowflake', 'scheduled__2024-03-29T00:00:00+00:00', '--job-id', '203', '--raw', '--subdir', 'DAGS_FOLDER/student_data_migration.py', '--cfg-path', '/tmp/tmp74d3nhy1']
[2024-03-30T02:40:32.793+0000] {standard_task_runner.py:88} INFO - Job 203: Subtask load_data_to_snowflake
[2024-03-30T02:40:32.830+0000] {task_command.py:423} INFO - Running <TaskInstance: migrate_student_data_to_snowflake.load_data_to_snowflake scheduled__2024-03-29T00:00:00+00:00 [running]> on host aa35e1f2b044
[2024-03-30T02:40:32.933+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='migrate_student_data_to_snowflake' AIRFLOW_CTX_TASK_ID='load_data_to_snowflake' AIRFLOW_CTX_EXECUTION_DATE='2024-03-29T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-03-29T00:00:00+00:00'
[2024-03-30T02:40:32.934+0000] {connection.py:386} INFO - Snowflake Connector for Python Version: 3.7.1, Python Version: 3.8.19, Platform: Linux-5.15.146.1-microsoft-standard-WSL2-x86_64-with-glibc2.34
[2024-03-30T02:40:32.935+0000] {connection.py:1211} INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
[2024-03-30T02:40:33.986+0000] {cursor.py:1032} INFO - query: [CREATE DATABASE IF NOT EXISTS VIEWS_STUDENTS]
[2024-03-30T02:40:34.069+0000] {cursor.py:1045} INFO - query execution done
[2024-03-30T02:40:34.070+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-03-30T02:40:34.071+0000] {cursor.py:1032} INFO - query: [USE DATABASE VIEWS_STUDENTS]
[2024-03-30T02:40:34.169+0000] {cursor.py:1045} INFO - query execution done
[2024-03-30T02:40:34.170+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-03-30T02:40:34.170+0000] {cursor.py:1032} INFO - query: [CREATE SCHEMA IF NOT EXISTS STUDENTS_SEMANTIC]
[2024-03-30T02:40:34.246+0000] {cursor.py:1045} INFO - query execution done
[2024-03-30T02:40:34.247+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-03-30T02:40:34.248+0000] {cursor.py:1032} INFO - query: [USE SCHEMA STUDENTS_SEMANTIC]
[2024-03-30T02:40:34.331+0000] {cursor.py:1045} INFO - query execution done
[2024-03-30T02:40:34.332+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-03-30T02:40:34.333+0000] {cursor.py:1032} INFO - query: [CREATE OR REPLACE TABLE FINAL_MERGED ( student_id VARCHAR, name VARCHAR, grades ...]
[2024-03-30T02:40:34.651+0000] {cursor.py:1045} INFO - query execution done
[2024-03-30T02:40:34.653+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-03-30T02:40:34.662+0000] {student_data_migration.py:137} ERROR - Error loading data into Snowflake: 252004: 252004: Failed processing pyformat-parameters; 255001: 255001: Binding data in type (dict) is not supported.
[2024-03-30T02:40:34.662+0000] {connection.py:734} INFO - closed
[2024-03-30T02:40:34.700+0000] {connection.py:740} INFO - No async queries seem to be running, deleting session
[2024-03-30T02:40:34.759+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 1517, in _process_params_pyformat
    ret = tuple(res)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 1563, in _process_single_param
    return _quote(escape(to_snowflake(param)))
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/converter.py", line 481, in to_snowflake
    return getattr(self, f"_{type_name}_to_snowflake")(value)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/converter.py", line 653, in __getattr__
    raise ProgrammingError(
snowflake.connector.errors.ProgrammingError: 255001: 255001: Binding data in type (dict) is not supported.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 200, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 217, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/student_data_migration.py", line 133, in load_data_to_snowflake
    cursor.executemany(query, data)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 1430, in executemany
    fmt % self._connection._process_params_pyformat(param, self)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 1521, in _process_params_pyformat
    Error.errorhandler_wrapper(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/errors.py", line 290, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/errors.py", line 345, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/errors.py", line 221, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 252004: 252004: Failed processing pyformat-parameters; 255001: 255001: Binding data in type (dict) is not supported.
[2024-03-30T02:40:34.767+0000] {taskinstance.py:1149} INFO - Marking task as UP_FOR_RETRY. dag_id=migrate_student_data_to_snowflake, task_id=load_data_to_snowflake, execution_date=20240329T000000, start_date=20240330T024032, end_date=20240330T024034
[2024-03-30T02:40:34.778+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 203 for task load_data_to_snowflake (252004: 252004: Failed processing pyformat-parameters; 255001: 255001: Binding data in type (dict) is not supported.; 90)
[2024-03-30T02:40:34.811+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-03-30T02:40:34.825+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-03-30T02:44:25.661+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: migrate_student_data_to_snowflake.load_data_to_snowflake scheduled__2024-03-29T00:00:00+00:00 [queued]>
[2024-03-30T02:44:25.668+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: migrate_student_data_to_snowflake.load_data_to_snowflake scheduled__2024-03-29T00:00:00+00:00 [queued]>
[2024-03-30T02:44:25.668+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 2
[2024-03-30T02:44:25.679+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): load_data_to_snowflake> on 2024-03-29 00:00:00+00:00
[2024-03-30T02:44:25.683+0000] {standard_task_runner.py:60} INFO - Started process 91 to run task
[2024-03-30T02:44:25.686+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'migrate_student_data_to_snowflake', 'load_data_to_snowflake', 'scheduled__2024-03-29T00:00:00+00:00', '--job-id', '213', '--raw', '--subdir', 'DAGS_FOLDER/student_data_migration.py', '--cfg-path', '/tmp/tmpe6fub_3m']
[2024-03-30T02:44:25.688+0000] {standard_task_runner.py:88} INFO - Job 213: Subtask load_data_to_snowflake
[2024-03-30T02:44:25.723+0000] {task_command.py:423} INFO - Running <TaskInstance: migrate_student_data_to_snowflake.load_data_to_snowflake scheduled__2024-03-29T00:00:00+00:00 [running]> on host 5f6fe71f0542
[2024-03-30T02:44:25.873+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='migrate_student_data_to_snowflake' AIRFLOW_CTX_TASK_ID='load_data_to_snowflake' AIRFLOW_CTX_EXECUTION_DATE='2024-03-29T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-03-29T00:00:00+00:00'
[2024-03-30T02:44:25.874+0000] {connection.py:386} INFO - Snowflake Connector for Python Version: 3.7.1, Python Version: 3.8.19, Platform: Linux-5.15.146.1-microsoft-standard-WSL2-x86_64-with-glibc2.34
[2024-03-30T02:44:25.875+0000] {connection.py:1211} INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
[2024-03-30T02:44:26.680+0000] {cursor.py:1032} INFO - query: [CREATE DATABASE IF NOT EXISTS VIEWS_STUDENTS]
[2024-03-30T02:44:26.800+0000] {cursor.py:1045} INFO - query execution done
[2024-03-30T02:44:26.801+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-03-30T02:44:26.802+0000] {cursor.py:1032} INFO - query: [USE DATABASE VIEWS_STUDENTS]
[2024-03-30T02:44:26.908+0000] {cursor.py:1045} INFO - query execution done
[2024-03-30T02:44:26.909+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-03-30T02:44:26.910+0000] {cursor.py:1032} INFO - query: [CREATE SCHEMA IF NOT EXISTS STUDENTS_SEMANTIC]
[2024-03-30T02:44:26.997+0000] {cursor.py:1045} INFO - query execution done
[2024-03-30T02:44:26.998+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-03-30T02:44:26.999+0000] {cursor.py:1032} INFO - query: [USE SCHEMA STUDENTS_SEMANTIC]
[2024-03-30T02:44:27.061+0000] {cursor.py:1045} INFO - query execution done
[2024-03-30T02:44:27.062+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-03-30T02:44:27.063+0000] {cursor.py:1032} INFO - query: [CREATE OR REPLACE TABLE FINAL_MERGED ( student_id VARCHAR, name VARCHAR, grades ...]
[2024-03-30T02:44:27.303+0000] {cursor.py:1045} INFO - query execution done
[2024-03-30T02:44:27.304+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-03-30T02:44:27.312+0000] {student_data_migration.py:143} ERROR - Error loading data into Snowflake: 252004: 252004: Failed processing pyformat-parameters; 255001: 255001: Binding data in type (dict) is not supported.
[2024-03-30T02:44:27.313+0000] {connection.py:734} INFO - closed
[2024-03-30T02:44:27.347+0000] {connection.py:740} INFO - No async queries seem to be running, deleting session
[2024-03-30T02:44:27.402+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 1517, in _process_params_pyformat
    ret = tuple(res)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 1563, in _process_single_param
    return _quote(escape(to_snowflake(param)))
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/converter.py", line 481, in to_snowflake
    return getattr(self, f"_{type_name}_to_snowflake")(value)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/converter.py", line 653, in __getattr__
    raise ProgrammingError(
snowflake.connector.errors.ProgrammingError: 255001: 255001: Binding data in type (dict) is not supported.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 200, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 217, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/student_data_migration.py", line 133, in load_data_to_snowflake
    cursor.execute(query, (
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 1000, in execute
    query = self._preprocess_pyformat_query(command, params)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 810, in _preprocess_pyformat_query
    processed_params = self._connection._process_params_pyformat(params, self)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 1521, in _process_params_pyformat
    Error.errorhandler_wrapper(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/errors.py", line 290, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/errors.py", line 345, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/errors.py", line 221, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 252004: 252004: Failed processing pyformat-parameters; 255001: 255001: Binding data in type (dict) is not supported.
[2024-03-30T02:44:27.409+0000] {taskinstance.py:1149} INFO - Marking task as UP_FOR_RETRY. dag_id=migrate_student_data_to_snowflake, task_id=load_data_to_snowflake, execution_date=20240329T000000, start_date=20240330T024425, end_date=20240330T024427
[2024-03-30T02:44:27.419+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 213 for task load_data_to_snowflake (252004: 252004: Failed processing pyformat-parameters; 255001: 255001: Binding data in type (dict) is not supported.; 91)
[2024-03-30T02:44:27.466+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-03-30T02:44:27.478+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-03-30T02:47:38.225+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: migrate_student_data_to_snowflake.load_data_to_snowflake scheduled__2024-03-29T00:00:00+00:00 [queued]>
[2024-03-30T02:47:38.232+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: migrate_student_data_to_snowflake.load_data_to_snowflake scheduled__2024-03-29T00:00:00+00:00 [queued]>
[2024-03-30T02:47:38.232+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 2
[2024-03-30T02:47:38.243+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): load_data_to_snowflake> on 2024-03-29 00:00:00+00:00
[2024-03-30T02:47:38.247+0000] {standard_task_runner.py:60} INFO - Started process 90 to run task
[2024-03-30T02:47:38.250+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'migrate_student_data_to_snowflake', 'load_data_to_snowflake', 'scheduled__2024-03-29T00:00:00+00:00', '--job-id', '223', '--raw', '--subdir', 'DAGS_FOLDER/student_data_migration.py', '--cfg-path', '/tmp/tmpgim330_b']
[2024-03-30T02:47:38.253+0000] {standard_task_runner.py:88} INFO - Job 223: Subtask load_data_to_snowflake
[2024-03-30T02:47:38.293+0000] {task_command.py:423} INFO - Running <TaskInstance: migrate_student_data_to_snowflake.load_data_to_snowflake scheduled__2024-03-29T00:00:00+00:00 [running]> on host 554ede018a86
[2024-03-30T02:47:38.403+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='migrate_student_data_to_snowflake' AIRFLOW_CTX_TASK_ID='load_data_to_snowflake' AIRFLOW_CTX_EXECUTION_DATE='2024-03-29T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-03-29T00:00:00+00:00'
[2024-03-30T02:47:38.405+0000] {connection.py:386} INFO - Snowflake Connector for Python Version: 3.7.1, Python Version: 3.8.19, Platform: Linux-5.15.146.1-microsoft-standard-WSL2-x86_64-with-glibc2.34
[2024-03-30T02:47:38.406+0000] {connection.py:1211} INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
[2024-03-30T02:47:39.183+0000] {cursor.py:1032} INFO - query: [CREATE DATABASE IF NOT EXISTS VIEWS_STUDENTS]
[2024-03-30T02:47:39.302+0000] {cursor.py:1045} INFO - query execution done
[2024-03-30T02:47:39.303+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-03-30T02:47:39.304+0000] {cursor.py:1032} INFO - query: [USE DATABASE VIEWS_STUDENTS]
[2024-03-30T02:47:39.396+0000] {cursor.py:1045} INFO - query execution done
[2024-03-30T02:47:39.397+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-03-30T02:47:39.397+0000] {cursor.py:1032} INFO - query: [CREATE SCHEMA IF NOT EXISTS STUDENTS_SEMANTIC]
[2024-03-30T02:47:39.511+0000] {cursor.py:1045} INFO - query execution done
[2024-03-30T02:47:39.512+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-03-30T02:47:39.513+0000] {cursor.py:1032} INFO - query: [USE SCHEMA STUDENTS_SEMANTIC]
[2024-03-30T02:47:39.599+0000] {cursor.py:1045} INFO - query execution done
[2024-03-30T02:47:39.600+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-03-30T02:47:39.600+0000] {cursor.py:1032} INFO - query: [CREATE OR REPLACE TABLE FINAL_MERGED ( student_id VARCHAR, name VARCHAR, grades ...]
[2024-03-30T02:47:39.903+0000] {cursor.py:1045} INFO - query execution done
[2024-03-30T02:47:39.905+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-03-30T02:47:39.907+0000] {student_data_migration.py:145} ERROR - Error loading data into Snowflake: not all arguments converted during string formatting
[2024-03-30T02:47:39.907+0000] {connection.py:734} INFO - closed
[2024-03-30T02:47:39.960+0000] {connection.py:740} INFO - No async queries seem to be running, deleting session
[2024-03-30T02:47:40.022+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 200, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 217, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/student_data_migration.py", line 135, in load_data_to_snowflake
    cursor.execute(query, (
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 1000, in execute
    query = self._preprocess_pyformat_query(command, params)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 832, in _preprocess_pyformat_query
    query = command % processed_params
TypeError: not all arguments converted during string formatting
[2024-03-30T02:47:40.034+0000] {taskinstance.py:1149} INFO - Marking task as UP_FOR_RETRY. dag_id=migrate_student_data_to_snowflake, task_id=load_data_to_snowflake, execution_date=20240329T000000, start_date=20240330T024738, end_date=20240330T024740
[2024-03-30T02:47:40.045+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 223 for task load_data_to_snowflake (not all arguments converted during string formatting; 90)
[2024-03-30T02:47:40.071+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-03-30T02:47:40.084+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-03-30T02:52:01.183+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: migrate_student_data_to_snowflake.load_data_to_snowflake scheduled__2024-03-29T00:00:00+00:00 [queued]>
[2024-03-30T02:52:01.192+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: migrate_student_data_to_snowflake.load_data_to_snowflake scheduled__2024-03-29T00:00:00+00:00 [queued]>
[2024-03-30T02:52:01.192+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 2
[2024-03-30T02:52:01.202+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): load_data_to_snowflake> on 2024-03-29 00:00:00+00:00
[2024-03-30T02:52:01.206+0000] {standard_task_runner.py:60} INFO - Started process 91 to run task
[2024-03-30T02:52:01.208+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'migrate_student_data_to_snowflake', 'load_data_to_snowflake', 'scheduled__2024-03-29T00:00:00+00:00', '--job-id', '234', '--raw', '--subdir', 'DAGS_FOLDER/student_data_migration.py', '--cfg-path', '/tmp/tmpvtvc0krh']
[2024-03-30T02:52:01.211+0000] {standard_task_runner.py:88} INFO - Job 234: Subtask load_data_to_snowflake
[2024-03-30T02:52:01.246+0000] {task_command.py:423} INFO - Running <TaskInstance: migrate_student_data_to_snowflake.load_data_to_snowflake scheduled__2024-03-29T00:00:00+00:00 [running]> on host 38988ffa029d
[2024-03-30T02:52:01.353+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='migrate_student_data_to_snowflake' AIRFLOW_CTX_TASK_ID='load_data_to_snowflake' AIRFLOW_CTX_EXECUTION_DATE='2024-03-29T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-03-29T00:00:00+00:00'
[2024-03-30T02:52:01.355+0000] {connection.py:386} INFO - Snowflake Connector for Python Version: 3.7.1, Python Version: 3.8.19, Platform: Linux-5.15.146.1-microsoft-standard-WSL2-x86_64-with-glibc2.34
[2024-03-30T02:52:01.356+0000] {connection.py:1211} INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
[2024-03-30T02:52:02.275+0000] {cursor.py:1032} INFO - query: [CREATE DATABASE IF NOT EXISTS VIEWS_STUDENTS]
[2024-03-30T02:52:02.479+0000] {cursor.py:1045} INFO - query execution done
[2024-03-30T02:52:02.480+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-03-30T02:52:02.480+0000] {cursor.py:1032} INFO - query: [USE DATABASE VIEWS_STUDENTS]
[2024-03-30T02:52:02.678+0000] {cursor.py:1045} INFO - query execution done
[2024-03-30T02:52:02.679+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-03-30T02:52:02.679+0000] {cursor.py:1032} INFO - query: [CREATE SCHEMA IF NOT EXISTS STUDENTS_SEMANTIC]
[2024-03-30T02:52:02.754+0000] {cursor.py:1045} INFO - query execution done
[2024-03-30T02:52:02.755+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-03-30T02:52:02.756+0000] {cursor.py:1032} INFO - query: [USE SCHEMA STUDENTS_SEMANTIC]
[2024-03-30T02:52:02.848+0000] {cursor.py:1045} INFO - query execution done
[2024-03-30T02:52:02.849+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-03-30T02:52:02.849+0000] {cursor.py:1032} INFO - query: [CREATE OR REPLACE TABLE FINAL_MERGED ( student_id VARCHAR, name VARCHAR, grades ...]
[2024-03-30T02:52:03.133+0000] {cursor.py:1045} INFO - query execution done
[2024-03-30T02:52:03.135+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-03-30T02:52:03.136+0000] {student_data_migration.py:148} ERROR - Error loading data into Snowflake: not all arguments converted during string formatting
[2024-03-30T02:52:03.137+0000] {connection.py:734} INFO - closed
[2024-03-30T02:52:03.172+0000] {connection.py:740} INFO - No async queries seem to be running, deleting session
[2024-03-30T02:52:03.225+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 200, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 217, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/student_data_migration.py", line 138, in load_data_to_snowflake
    cursor.execute(query, (
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 1000, in execute
    query = self._preprocess_pyformat_query(command, params)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 832, in _preprocess_pyformat_query
    query = command % processed_params
TypeError: not all arguments converted during string formatting
[2024-03-30T02:52:03.236+0000] {taskinstance.py:1149} INFO - Marking task as UP_FOR_RETRY. dag_id=migrate_student_data_to_snowflake, task_id=load_data_to_snowflake, execution_date=20240329T000000, start_date=20240330T025201, end_date=20240330T025203
[2024-03-30T02:52:03.252+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 234 for task load_data_to_snowflake (not all arguments converted during string formatting; 91)
[2024-03-30T02:52:03.271+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-03-30T02:52:03.283+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-03-30T03:01:32.651+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: migrate_student_data_to_snowflake.load_data_to_snowflake scheduled__2024-03-29T00:00:00+00:00 [queued]>
[2024-03-30T03:01:32.658+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: migrate_student_data_to_snowflake.load_data_to_snowflake scheduled__2024-03-29T00:00:00+00:00 [queued]>
[2024-03-30T03:01:32.658+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 2
[2024-03-30T03:01:32.670+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): load_data_to_snowflake> on 2024-03-29 00:00:00+00:00
[2024-03-30T03:01:32.676+0000] {standard_task_runner.py:60} INFO - Started process 98 to run task
[2024-03-30T03:01:32.679+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'migrate_student_data_to_snowflake', 'load_data_to_snowflake', 'scheduled__2024-03-29T00:00:00+00:00', '--job-id', '246', '--raw', '--subdir', 'DAGS_FOLDER/student_data_migration.py', '--cfg-path', '/tmp/tmp0l0q0moj']
[2024-03-30T03:01:32.681+0000] {standard_task_runner.py:88} INFO - Job 246: Subtask load_data_to_snowflake
[2024-03-30T03:01:32.727+0000] {task_command.py:423} INFO - Running <TaskInstance: migrate_student_data_to_snowflake.load_data_to_snowflake scheduled__2024-03-29T00:00:00+00:00 [running]> on host 683019c18b1b
[2024-03-30T03:01:32.999+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='migrate_student_data_to_snowflake' AIRFLOW_CTX_TASK_ID='load_data_to_snowflake' AIRFLOW_CTX_EXECUTION_DATE='2024-03-29T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-03-29T00:00:00+00:00'
[2024-03-30T03:01:33.002+0000] {connection.py:386} INFO - Snowflake Connector for Python Version: 3.7.1, Python Version: 3.8.19, Platform: Linux-5.15.146.1-microsoft-standard-WSL2-x86_64-with-glibc2.34
[2024-03-30T03:01:33.004+0000] {connection.py:1211} INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
[2024-03-30T03:01:33.920+0000] {cursor.py:1032} INFO - query: [CREATE DATABASE IF NOT EXISTS VIEWS_STUDENTS]
[2024-03-30T03:01:34.057+0000] {cursor.py:1045} INFO - query execution done
[2024-03-30T03:01:34.058+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-03-30T03:01:34.058+0000] {cursor.py:1032} INFO - query: [USE DATABASE VIEWS_STUDENTS]
[2024-03-30T03:01:34.148+0000] {cursor.py:1045} INFO - query execution done
[2024-03-30T03:01:34.149+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-03-30T03:01:34.149+0000] {cursor.py:1032} INFO - query: [CREATE SCHEMA IF NOT EXISTS STUDENTS_SEMANTIC]
[2024-03-30T03:01:34.225+0000] {cursor.py:1045} INFO - query execution done
[2024-03-30T03:01:34.226+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-03-30T03:01:34.227+0000] {cursor.py:1032} INFO - query: [USE SCHEMA STUDENTS_SEMANTIC]
[2024-03-30T03:01:34.307+0000] {cursor.py:1045} INFO - query execution done
[2024-03-30T03:01:34.308+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-03-30T03:01:34.308+0000] {cursor.py:1032} INFO - query: [CREATE OR REPLACE TABLE FINAL_MERGED ( student_id VARCHAR, name VARCHAR, grades ...]
[2024-03-30T03:01:34.600+0000] {cursor.py:1045} INFO - query execution done
[2024-03-30T03:01:34.601+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-03-30T03:01:34.602+0000] {student_data_migration.py:148} ERROR - Error loading data into Snowflake: not all arguments converted during string formatting
[2024-03-30T03:01:34.603+0000] {connection.py:734} INFO - closed
[2024-03-30T03:01:34.640+0000] {connection.py:740} INFO - No async queries seem to be running, deleting session
[2024-03-30T03:01:34.701+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 200, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 217, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/student_data_migration.py", line 138, in load_data_to_snowflake
    cursor.execute(query, (
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 1000, in execute
    query = self._preprocess_pyformat_query(command, params)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 832, in _preprocess_pyformat_query
    query = command % processed_params
TypeError: not all arguments converted during string formatting
[2024-03-30T03:01:34.743+0000] {taskinstance.py:1149} INFO - Marking task as UP_FOR_RETRY. dag_id=migrate_student_data_to_snowflake, task_id=load_data_to_snowflake, execution_date=20240329T000000, start_date=20240330T030132, end_date=20240330T030134
[2024-03-30T03:01:34.774+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 246 for task load_data_to_snowflake (not all arguments converted during string formatting; 98)
[2024-03-30T03:01:34.821+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-03-30T03:01:34.841+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-03-30T03:23:31.647+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: migrate_student_data_to_snowflake.load_data_to_snowflake scheduled__2024-03-29T00:00:00+00:00 [queued]>
[2024-03-30T03:23:31.655+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: migrate_student_data_to_snowflake.load_data_to_snowflake scheduled__2024-03-29T00:00:00+00:00 [queued]>
[2024-03-30T03:23:31.656+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 2
[2024-03-30T03:23:31.665+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): load_data_to_snowflake> on 2024-03-29 00:00:00+00:00
[2024-03-30T03:23:31.671+0000] {standard_task_runner.py:60} INFO - Started process 106 to run task
[2024-03-30T03:23:31.673+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'migrate_student_data_to_snowflake', 'load_data_to_snowflake', 'scheduled__2024-03-29T00:00:00+00:00', '--job-id', '259', '--raw', '--subdir', 'DAGS_FOLDER/student_data_migration.py', '--cfg-path', '/tmp/tmpb6ge5bhr']
[2024-03-30T03:23:31.676+0000] {standard_task_runner.py:88} INFO - Job 259: Subtask load_data_to_snowflake
[2024-03-30T03:23:31.713+0000] {task_command.py:423} INFO - Running <TaskInstance: migrate_student_data_to_snowflake.load_data_to_snowflake scheduled__2024-03-29T00:00:00+00:00 [running]> on host 7fb200567cf8
[2024-03-30T03:23:31.878+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='migrate_student_data_to_snowflake' AIRFLOW_CTX_TASK_ID='load_data_to_snowflake' AIRFLOW_CTX_EXECUTION_DATE='2024-03-29T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-03-29T00:00:00+00:00'
[2024-03-30T03:23:31.880+0000] {connection.py:386} INFO - Snowflake Connector for Python Version: 3.7.1, Python Version: 3.8.19, Platform: Linux-5.15.146.1-microsoft-standard-WSL2-x86_64-with-glibc2.34
[2024-03-30T03:23:31.881+0000] {connection.py:1211} INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
[2024-03-30T03:23:34.394+0000] {cursor.py:1032} INFO - query: [CREATE DATABASE IF NOT EXISTS VIEWS_STUDENTS]
[2024-03-30T03:23:34.521+0000] {cursor.py:1045} INFO - query execution done
[2024-03-30T03:23:34.522+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-03-30T03:23:34.523+0000] {cursor.py:1032} INFO - query: [USE DATABASE VIEWS_STUDENTS]
[2024-03-30T03:23:34.619+0000] {cursor.py:1045} INFO - query execution done
[2024-03-30T03:23:34.620+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-03-30T03:23:34.620+0000] {cursor.py:1032} INFO - query: [CREATE SCHEMA IF NOT EXISTS STUDENTS_SEMANTIC]
[2024-03-30T03:23:34.701+0000] {cursor.py:1045} INFO - query execution done
[2024-03-30T03:23:34.701+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-03-30T03:23:34.702+0000] {cursor.py:1032} INFO - query: [USE SCHEMA STUDENTS_SEMANTIC]
[2024-03-30T03:23:34.809+0000] {cursor.py:1045} INFO - query execution done
[2024-03-30T03:23:34.810+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-03-30T03:23:34.810+0000] {cursor.py:1032} INFO - query: [CREATE OR REPLACE TABLE FINAL_MERGED ( student_id VARCHAR, name VARCHAR, grades ...]
[2024-03-30T03:23:35.093+0000] {cursor.py:1045} INFO - query execution done
[2024-03-30T03:23:35.094+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-03-30T03:23:35.095+0000] {student_data_migration.py:148} ERROR - Error loading data into Snowflake: not all arguments converted during string formatting
[2024-03-30T03:23:35.095+0000] {connection.py:734} INFO - closed
[2024-03-30T03:23:35.136+0000] {connection.py:740} INFO - No async queries seem to be running, deleting session
[2024-03-30T03:23:35.196+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 200, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 217, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/student_data_migration.py", line 138, in load_data_to_snowflake
    cursor.execute(query, (
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 1000, in execute
    query = self._preprocess_pyformat_query(command, params)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 832, in _preprocess_pyformat_query
    query = command % processed_params
TypeError: not all arguments converted during string formatting
[2024-03-30T03:23:35.205+0000] {taskinstance.py:1149} INFO - Marking task as UP_FOR_RETRY. dag_id=migrate_student_data_to_snowflake, task_id=load_data_to_snowflake, execution_date=20240329T000000, start_date=20240330T032331, end_date=20240330T032335
[2024-03-30T03:23:35.221+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 259 for task load_data_to_snowflake (not all arguments converted during string formatting; 106)
[2024-03-30T03:23:35.262+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-03-30T03:23:35.276+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
